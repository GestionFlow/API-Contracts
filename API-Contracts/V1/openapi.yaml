openapi: 3.0.4
info:
  title: Task Management API
  version: 1.0.0
  description: API for managing tasks and users
servers:
  - url: http://api.example.com/v1
    description: Production server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    $ref: "./authentication/auth-defs.yaml#/components/schemas"

tags:
  - name: Authentication
    description: Endpoints related to auth
  - name: User Management
    description: Endpoints related to users
  - name: Task Management
    description: Endpoints related to tasks

# Authentication endpoints
paths:
  /auth/register:
    post:
      tags:
        - Authentication
      summary: Create a new user account
      description: Register a new user with name, email, and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - email
                - password
              properties:
                name:
                  type: string
                  example: Pranav
                email:
                  type: string
                  format: email
                  example: pranav@example.com
                password:
                  type: string
                  format: password
                  minLength: 8
                  example: secure123
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        '409':
          description: User already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/login:
    post:
      tags:
        - Authentication
      summary: Authenticate user and get JWT tokens
      description: Authenticate a user with email and password to receive access and refresh tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Invalidate refresh token
      description: Log out the current user by invalidating their refresh token
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully logged out
        '401':
          description: Unauthorized - invalid or missing token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: Get a new access token using a valid refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  description: Valid refresh token
      responses:
        '200':
          description: New access token generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                    description: New JWT access token
        '401':
          description: Invalid or expired refresh token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # User and Task management endpoints will be included from other files
  /users:
    $ref: "./users/users-api.yaml"
  /tasks:
    $ref: "./tasks/tasks-api.yaml"